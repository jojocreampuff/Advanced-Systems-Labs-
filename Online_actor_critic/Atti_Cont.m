

function torque_outputs = Atti_Cont(x,Ix,Iy,Iz,parameters)


R =  diag([1,1,1]);

g = [0 0 0; 0 0 0; 0 0 0; 1/Ix 0 0; 0 1/Iy 0; 0 0 1/Iz];

W2 = parameters;

grad_phi = [ ...
    0, 0, 0, 0, 0, 0;
    2*x(1,1),    0,    0,    0,    0,    0
    0, 2*x(2,1),    0,    0,    0,    0
    0,    0, 2*x(3,1),    0,    0,    0
    0,    0,    0, 2*x(4,1),    0,    0
    0,    0,    0,    0, 2*x(5,1),    0
    0,    0,    0,    0,    0, 2*x(6,1)
    x(2,1),   x(1,1),    0,    0,    0,    0
    x(3,1),    0,   x(1,1),    0,    0,    0
    x(4,1),    0,    0,   x(1,1),    0,    0
    x(5,1),    0,    0,    0,   x(1,1),    0
    x(6,1),    0,    0,    0,    0,   x(1,1)
    0,   x(3,1),   x(2,1),    0,    0,    0
    0,   x(4,1),    0,   x(2,1),    0,    0
    0,   x(5,1),    0,    0,   x(2,1),    0
    0,   x(6,1),    0,    0,    0,   x(2,1)
    0,    0,   x(4,1),   x(3,1),    0,    0
    0,    0,   x(5,1),    0,   x(3,1),    0
    0,    0,   x(6,1),    0,    0,   x(3,1)
    0,    0,    0,   x(5,1),   x(4,1),    0
    0,    0,    0,   x(6,1),    0,   x(4,1)
    0,    0,    0,    0,   x(6,1),   x(5,1)
    ];


GRAD_PHI = grad_phi;


% W2 = [1
% 0.999362791872949
% 1.04356163032522
% 0.970831752944630
% 1.09503933491184
% 0.917319397846365
% 1.14293334841399
% 0.965781828411096
% 1.01818894584562
% 1.10234260290974
% 0.265732458110251
% 1.14807263659832
% 1.00631185359113
% 1.38931948752065
% 1.89136061373241
% 0.486538664233447
% 0.601151699942711
% 0.737342929409218
% 1.46127901559669
% 0.897887581830712
% 1.01570239220265
% 1.04690992683673]



 T_xyz = -0.5 * R^-1 * g.' * GRAD_PHI.' * W2;

 torque_outputs = T_xyz;

end
